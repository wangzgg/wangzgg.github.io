var S=(v,c,u)=>new Promise((_,r)=>{var p=t=>{try{f(u.next(t))}catch(l){r(l)}},w=t=>{try{f(u.throw(t))}catch(l){r(l)}},f=t=>t.done?_(t.value):Promise.resolve(t.value).then(p,w);f((u=u.apply(v,c)).next())});import{_ as W}from"./_plugin-vue_export-helper-769736d6.js";import{E as Z,a as q,b as H}from"./el-col-857ed269.js";import{p as N,E as J}from"./pdf-0a25992a.js";import{E as K,a as Q}from"./el-scrollbar-938d82b3.js";import{r as n,u as X,a as Y,o as i,c as ee,w as k,b as h,d as e,e as g,F as se,f as te,g as oe,h as le,t as T,i as C,v as b,n as ae,p as ne,j as re}from"./index-8d4ecac5.js";import{p as z}from"./http-07ca124c.js";import{E as ue}from"./el-message-0d328fa6.js";const d=v=>(ne("data-v-411f5fcd"),v=v(),re(),v),ce=d(()=>e("div",{class:"bg"},null,-1)),ie={class:"right"},de={key:0,class:"showPdf"},ve=["id"],_e={class:"close_pdf"},pe={key:1,class:"register"},fe=d(()=>e("div",{class:"first_level_text"},"欢迎注册新用户",-1)),me=d(()=>e("span",null,"已有账号？",-1)),he={key:0,class:"warn_info"},ge={key:1,class:"warn_m"},we=d(()=>e("div",{class:"user_tel second_level_text"},"邮箱",-1)),xe={class:"input_user"},ye={class:"verification_code input_user"},ke=["disabled"],Ce=d(()=>e("div",{class:"user_name second_level_text"},"用户名",-1)),be={class:"input_user"},Ee=d(()=>e("div",{class:"password second_level_text"},"密码",-1)),Ve={class:"input_user"},Pe=d(()=>e("div",{class:"password second_level_text"},"重复密码",-1)),Ie={class:"input_user"},De={class:"read_info"},Ue=60,Be={__name:"Register",setup(v){N.GlobalWorkerOptions.workerSrc="pdf.worker.min.js";const c=n(""),u=n(""),_=n(""),r=n(""),p=n(""),w=n(!1),f=X(),t=n(!1),l=n(""),P=n(!1);let I=n(0),D=Y({});const E=n("获取验证码"),V=n(!1),F=()=>S(this,null,function*(){if(!M(c.value)){t.value=!0,l.value="请输入正确的邮箱";return}V.value=!0,(yield z("/accounts/sendemail",{email:c.value})).code==200?L():l.value="发送验证码失败"}),L=()=>{let s=Ue;E.value=s;const o=setInterval(()=>{s--,s===0?(clearInterval(o),V.value=!1,E.value="重新发送"):E.value=`${s}s`},1e3)},j=()=>{f.push({path:"/"})},M=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),A=()=>S(this,null,function*(){if(!M(c.value)){t.value=!0,l.value="邮箱格式不正确";return}if(u.value.length!=6){t.value=!0,l.value="请输入6位验证码";return}if(_.value.length<1){t.value=!0,l.value="用户名不能为空";return}if(r.value.length<8){t.value=!0,l.value="密码长度不能小于8位";return}else if(!/[a-z]/.test(r.value)||!/[A-Z]/.test(r.value)){t.value=!0,l.value="密码必须包含大小写字母",console.log("output->errorMsg.value",l.value);return}else if(!/\d/.test(r.value)){t.value=!0,l.value="密码必须包含数字";return}if(r.value!=p.value){t.value=!0,l.value="两次输入密码不匹配";return}if(w.value)t.value=!1;else{t.value=!0,l.value="请阅读并勾选相关条款";return}try{const s=yield z("/accounts/register",{company_name:"浦原",username:_.value,password:r.value,email:c.value,code:u.value,checkPassword:p.value});console.log(s),s.code==200?(f.push({path:"/"}),ue({message:"注册成功",type:"success"})):(t.value=!0,l.value=s.msg)}catch(s){throw s}}),$=()=>{P.value=!0;const s="用户服务协议和隐私政策.pdf";N.getDocument(s).promise.then(m=>{I.value=m.numPages,D=m,console.log(D),R(1)})},R=s=>{D.getPage(s).then(o=>{const x=o.getViewport({scale:1.1}),y=document.getElementById("pdf-canvas-"+s),U=y.getContext("2d");y.height=x.height,y.width=x.width;const B={canvasContext:U,viewport:x};o.render(B),s<I.value&&R(s+1)})},G=()=>{P.value=!1};return(s,o)=>{const m=q,x=K,y=Q,U=H,B=J,O=Z;return i(),ee(O,null,{default:k(()=>[h(m,{span:14},{default:k(()=>[ce]),_:1}),h(m,{span:10},{default:k(()=>[e("div",ie,[P.value?(i(),g("div",de,[h(x,{height:"850px"},{default:k(()=>[(i(!0),g(se,null,te(oe(I),a=>(i(),g("canvas",{id:"pdf-canvas-"+a,key:a,style:{display:"block"}},null,8,ve))),128))]),_:1}),e("div",_e,[h(y,{type:"primary",onClick:G},{default:k(()=>[le("关闭")]),_:1})])])):(i(),g("div",pe,[fe,e("div",{class:"new_user"},[me,e("span",{class:"theme_color",onClick:j},"登录账号")]),t.value?(i(),g("div",he,[h(U,{style:{width:"16px",height:"16px"},src:"warn.svg"}),e("span",null,T(l.value),1)])):(i(),g("div",ge)),we,e("div",xe,[C(e("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>c.value=a),placeholder:"请输入邮箱"},null,512),[[b,c.value]])]),e("div",ye,[C(e("input",{style:{width:"196px"},"onUpdate:modelValue":o[1]||(o[1]=a=>u.value=a),placeholder:"请输入验证码"},null,512),[[b,u.value]]),e("button",{disabled:V.value,onClick:F,class:ae(V.value?"counting_down":"active_style")},T(E.value),11,ke)]),Ce,e("div",be,[C(e("input",{"onUpdate:modelValue":o[2]||(o[2]=a=>_.value=a),placeholder:"请输入用户名"},null,512),[[b,_.value]])]),Ee,e("div",Ve,[C(e("input",{"onUpdate:modelValue":o[3]||(o[3]=a=>r.value=a),type:"password",placeholder:"请输入密码","show-password":""},null,512),[[b,r.value]])]),Pe,e("div",Ie,[C(e("input",{"onUpdate:modelValue":o[4]||(o[4]=a=>p.value=a),type:"password",placeholder:"请重复密码","show-password":""},null,512),[[b,p.value]])]),e("div",{style:{"margin-top":"25px"}},[e("button",{class:"login_button",onClick:A},"注册")]),e("div",De,[h(B,{modelValue:w.value,"onUpdate:modelValue":o[5]||(o[5]=a=>w.value=a),label:"我已阅读并同意",size:"large"},null,8,["modelValue"]),e("span",{class:"password_text theme_color",onClick:$},"《服务协议和隐私政策》")])]))])]),_:1})]),_:1})}}},je=W(Be,[["__scopeId","data-v-411f5fcd"]]);export{je as default};
