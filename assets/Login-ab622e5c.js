var P=(u,p,l)=>new Promise((b,c)=>{var h=t=>{try{r(l.next(t))}catch(i){c(i)}},g=t=>{try{r(l.throw(t))}catch(i){c(i)}},r=t=>t.done?b(t.value):Promise.resolve(t.value).then(h,g);r((l=l.apply(u,p)).next())});import{_ as j}from"./_plugin-vue_export-helper-769736d6.js";import{E as z,a as M,b as W}from"./el-col-857ed269.js";import{p as S,E as q}from"./pdf-0a25992a.js";import{E as A,a as G}from"./el-scrollbar-938d82b3.js";import{r as n,u as K,a as O,o as d,c as H,w as x,b as _,d as e,e as m,F as J,f as Q,g as I,h as X,t as Y,i as B,v as L,p as Z,j as $}from"./index-8d4ecac5.js";import{p as ee}from"./http-07ca124c.js";const y=u=>(Z("data-v-010dc930"),u=u(),$(),u),se=y(()=>e("div",{class:"bg"},null,-1)),oe={class:"right"},te={key:0,class:"showPdf"},ae=["id"],le={class:"close_pdf"},ne={key:1,class:"login"},ce=y(()=>e("div",{class:"first_level_text"},"欢迎使用账号密码登录",-1)),re=y(()=>e("span",null,"新用户？",-1)),ie={key:0,class:"warn_info"},de={key:1,class:"warn_m"},_e=y(()=>e("div",{class:"user_name second_level_text"},"账号",-1)),ue={class:"input_user"},pe=y(()=>e("div",{class:"password second_level_text"},"密码",-1)),ve={class:"input_user"},me={class:"keep_login"},he={class:"read_info"},ge={__name:"Login",setup(u){S.GlobalWorkerOptions.workerSrc="pdf.worker.min.js";const p=n(""),l=n(""),b=n(!1),c=n(!1),h=K(),g=n(!1);let r=n(0),t=O({}),i=n("");const f=n(!1),D=()=>{h.push({path:"/register"})},N=()=>P(this,null,function*(){if(console.log(c.value),c.value)f.value=!1;else{f.value=!0,i.value="请阅读并勾选相关条款";return}try{const s=yield ee("/api/accounts/login/password/",{username:p.value,password:l.value});console.log(s),s.code==200?(localStorage.setItem("token",s.data.access_token),localStorage.setItem("userName",p.value),h.push({path:"/question_main"}),f.value=!1):(f.value=!0,i.value=s.msg)}catch(s){throw s}}),T=()=>{h.push({path:"/retrieve"})},U=()=>{g.value=!0;const s="用户服务协议和隐私政策.pdf";S.getDocument(s).promise.then(v=>{r.value=v.numPages,t=v,console.log(t),V(1)})},V=s=>{t.getPage(s).then(o=>{const w=o.getViewport({scale:1.1}),k=document.getElementById("pdf-canvas-"+s),E=k.getContext("2d");k.height=w.height,k.width=w.width;const C={canvasContext:E,viewport:w};o.render(C),s<r.value&&V(s+1)})},F=()=>{g.value=!1};return(s,o)=>{const v=M,w=A,k=G,E=W,C=q,R=z;return d(),H(R,{style:{"background-color":"aliceblue"}},{default:x(()=>[_(v,{span:14},{default:x(()=>[se]),_:1}),_(v,{span:10},{default:x(()=>[e("div",oe,[g.value?(d(),m("div",te,[_(w,{height:"850px"},{default:x(()=>[(d(!0),m(J,null,Q(I(r),a=>(d(),m("canvas",{id:"pdf-canvas-"+a,key:a,style:{display:"block"}},null,8,ae))),128))]),_:1}),e("div",le,[_(k,{type:"primary",onClick:F},{default:x(()=>[X("关闭")]),_:1})])])):(d(),m("div",ne,[ce,e("div",{class:"new_user"},[re,e("span",{class:"theme_color",onClick:D},"创建账号")]),f.value?(d(),m("div",ie,[_(E,{style:{width:"16px",height:"16px"},src:"warn.svg"}),e("span",null,Y(I(i)),1)])):(d(),m("div",de)),_e,e("div",ue,[B(e("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>p.value=a),placeholder:"请输入账号/邮箱"},null,512),[[L,p.value]])]),pe,e("div",ve,[B(e("input",{"onUpdate:modelValue":o[1]||(o[1]=a=>l.value=a),type:"password",placeholder:"请输入密码","show-password":""},null,512),[[L,l.value]])]),e("div",me,[_(C,{modelValue:b.value,"onUpdate:modelValue":o[2]||(o[2]=a=>b.value=a),label:"保持登录状态",size:"large"},null,8,["modelValue"]),e("span",{class:"password_text theme_color",onClick:T},"忘记密码")]),e("div",{style:{"margin-top":"25px"}},[e("button",{class:"login_button",onClick:N},"登录")]),e("div",he,[_(C,{modelValue:c.value,"onUpdate:modelValue":o[3]||(o[3]=a=>c.value=a),label:"我已阅读并同意",size:"large"},null,8,["modelValue"]),e("span",{class:"theme_color",onClick:U},"《服务协议和隐私政策》")])]))])]),_:1})]),_:1})}}},Ee=j(ge,[["__scopeId","data-v-010dc930"]]);export{Ee as default};
